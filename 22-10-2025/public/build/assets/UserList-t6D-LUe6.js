import{a as o,r as d,j as e}from"./app-D5LrGWPf.js";import{y as n}from"./index-_iQ4wFyz.js";const i={getAll:async()=>{try{const s=await o.get("/users");return console.log("Audit response:",s.data),Array.isArray(s.data.data)?s.data.data:[]}catch(s){return console.error("Gagal mengambil daftar user",s),[]}},getById:async s=>{try{return(await o.get(`/users/${s}`)).data.data||null}catch(r){return console.error(`Gagal mengambil user dengan ID ${s}`,r),null}},create:async s=>{try{return(await o.post("/users",s)).data.data}catch(r){throw console.error("Gagal membuat user",r),r}},update:async(s,r)=>{try{return(await o.put(`/users/${s}`,r)).data.data}catch(t){throw console.error(`Gagal mengupdate user dengan ID ${s}`,t),t}},delete:async s=>{try{return(await o.delete(`/users/${s}`)).data}catch(r){throw console.error(`Gagal menghapus user dengan ID ${s}`,r),r}}},g={primary_karyawan_id:"",karyawan_bagian:"",name:"",email:"",password:"",whatsapp_number:"",foto_profile:""},_=()=>{const[s,r]=d.useState([]),[t,m]=d.useState(g),[c,h]=d.useState(null),[u,x]=d.useState(!1),p=async()=>{try{const a=await i.getAll();console.log("Data user:",a),r(a)}catch{n.error("Gagal memuat data user")}};d.useEffect(()=>{p()},[]);const l=a=>{m({...t,[a.target.name]:a.target.value})},b=async a=>{a.preventDefault(),x(!0);try{c?(await i.update(c,t),n.success("User berhasil diupdate")):(await i.create(t),n.success("User berhasil ditambahkan")),m(g),h(null),p()}catch(w){n.error("Gagal menyimpan user"),console.error(w)}finally{x(!1)}},f=a=>{m({primary_karyawan_id:a.primary_karyawan_id||"",karyawan_bagian:a.karyawan_bagian||"",name:a.name,email:a.email,password:"",whatsapp_number:a.whatsapp_number||"",foto_profile:a.foto_profile||""}),h(a.id)},y=async a=>{if(window.confirm("Yakin ingin menghapus user ini?"))try{await i.delete(a),n.success("User berhasil dihapus"),p()}catch{n.error("Gagal menghapus user")}};return e.jsxs("div",{className:"p-4 text-sm",children:[e.jsx("h1",{className:"text-lg font-bold mb-4",children:c?"Edit User":"Tambah User"}),e.jsxs("form",{onSubmit:b,className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsx("input",{name:"name",placeholder:"Nama",value:t.name,onChange:l,required:!0,className:"border p-2 rounded text-sm"}),e.jsx("input",{name:"email",placeholder:"Email",type:"email",value:t.email,onChange:l,required:!0,className:"border p-2 rounded text-sm"}),e.jsx("input",{name:"password",placeholder:"Password",type:"password",value:t.password,onChange:l,className:"border p-2 rounded text-sm"}),e.jsx("input",{name:"whatsapp_number",placeholder:"No WhatsApp",value:t.whatsapp_number,onChange:l,className:"border p-2 rounded text-sm"}),e.jsx("input",{name:"foto_profile",placeholder:"URL Foto Profil",value:t.foto_profile,onChange:l,className:"border p-2 rounded text-sm"}),e.jsx("button",{type:"submit",disabled:u,className:"bg-blue-600 text-white p-2 rounded hover:bg-blue-700 text-sm",children:u?"Menyimpan...":c?"Update User":"Tambah User"})]}),e.jsx("h2",{className:"text-lg font-bold mb-2",children:"Daftar User"}),e.jsxs("table",{className:"min-w-full border text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"p-2 text-left",children:"Nama"}),e.jsx("th",{className:"p-2 text-left",children:"Email"}),e.jsx("th",{className:"p-2 text-left",children:"WhatsApp"}),e.jsx("th",{className:"p-2 text-left",children:"Foto"}),e.jsx("th",{className:"p-2 text-left",children:"Aksi"})]})}),e.jsxs("tbody",{children:[s.map(a=>e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"p-2",children:a.name}),e.jsx("td",{className:"p-2",children:a.email}),e.jsx("td",{className:"p-2",children:a.whatsapp_number||"-"}),e.jsx("td",{className:"p-2",children:a.foto_profile?e.jsx("img",{src:a.foto_profile,alt:"foto",className:"w-10 h-10 rounded-full"}):"-"}),e.jsxs("td",{className:"p-2",children:[e.jsx("button",{onClick:()=>f(a),className:"bg-yellow-500 text-white px-2 py-1 rounded hover:bg-yellow-600 mr-2 text-sm",children:"Edit"}),e.jsx("button",{onClick:()=>y(a.id),className:"bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600 text-sm",children:"Hapus"})]})]},a.id)),s.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center p-2",children:"Belum ada user"})})]})]})]})};export{_ as default};
